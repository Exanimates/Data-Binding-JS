class Model 
{
    constructor(mount, initial) 
    {
        this.mount = mount;
        this.initial = initial;
        this.sub = [];      
        var databind=document.querySelector(mount).querySelectorAll("[data-bind]");
        Array.from(databind).forEach(elem=>{         
            const attribute=elem.dataset['bind'];
            if (elem.type=="checkbox") 
                elem.addEventListener("change",()=>this.set(attribute,elem.checked))
                else
            elem.addEventListener('input',()=>this.set(attribute,elem.value))
        })      
    }
    
        
    subscribe(fn)
    {
        this.sub.push(fn);        
    }
    
    set(key, value)
    {
         key = key.split(".");
         if  (key.length == 1)
		         this.initial[key] = value;
          else			   
			 {				
				var object = this.initial;
				for (var i=0;i<key.length;i++)
					{
						if (typeof object[key[i]]!='object' && typeof object[key[i]]!='undefined')
							object[key[i]] = value;
						else							
						   object = object[key[i]];							
					}
			 } 
	  this.sub.forEach(l=>l(key,value));
    }

    get(key,value)
    {
        
    }
    toObject()
    {
        return this.initial;
    }
    
}



window.Model = Model